# R-Guardian
A program that detects and defends against ransomware

# 🔐 Ransomware Entropy Detector

이 프로젝트는 **파일의 다중 엔트로피(entropy) 변화를 기반으로 랜섬웨어를 탐지**하고, 의심스러운 행위를 보이는 프로그램을 **자동으로 차단 및 강제 종료**하는 시스템입니다.  
Watchdog 기반의 실시간 파일 감시 기능과 `psutil`을 이용한 프로세스 제어 기능을 포함하고 있습니다.

## 📁 구성 파일 설명

| 파일명            | 설명 |
|------------------|------|
| `entropy.py`     | 파일의 다중 엔트로피를 계산하고, 일정 기준 이상이면 "의심스러움"으로 판단합니다. |
| `threshold.py`   | 의심스러운 엔트로피의 기준(threshold value)을 정의합니다. 일반적으로 7.5 이상을 기준으로 합니다. |
| `Guardian.py`  | 실시간으로 디렉터리를 감시하며, 변경된 파일의 엔트로피를 확인하여 랜섬웨어 행위로 판단되면 백업을 생성하고 실행 중인 관련 프로그램을 종료합니다. |

## ⚙️ 동작 방식

1. **폴더 내 파일 변경 감지**  
   `watchdog`을 사용하여 사용자가 지정한 폴더를 실시간 감시합니다.

2. **파일 엔트로피 분석**  
   파일이 수정되면 `entropy.py`를 통해 해당 파일의 다중 엔트로피를 계산합니다.

3. **의심 파일 판별**  
   `threshold.py`에서 정의된 기준을 초과하는 엔트로피일 경우, 암호화된 가능성이 있다고 판단합니다.

4. **대응 조치**  
   - 원본 파일 `.bak` 백업 생성  
   - 해당 파일을 열고 있는 프로그램(프로세스)을 찾아 `psutil`을 통해 종료 시도  
   - 차단된 실행 파일 목록을 관리하여 재실행 방지

## 🚧 한계점 및 아쉬운 점

- 일부 **프로세스에 대해 강제 종료가 제대로 동작하지 않을 수 있음**  
  (특히 관리자 권한이 필요한 시스템 프로세스나, 백그라운드 서비스 형태의 실행 파일)
- 차단 목록은 현재 수동으로 구성되어야 하며, 자동 업데이트 및 관리 기능은 추후 개선 필요
- 각 엔트로피에 대한 정확한 가중치를 몰라서 탐지가 완벽하지 않음

## 💡 향후 개선 아이디어

- 엔트로피 외의 추가 탐지 기준 도입 (예: 파일 확장자 변조, 대량 파일 변경 감지 등)  
- 강제 종료 실패 시 사용자에게 알림 또는 로그 저장 기능
- 백업된 파일 자동 복구 옵션 제공
- 각 엔트로피에 대한 정확한 가중치 찾기

## 🛡️ 목적

본 프로젝트는 **사전 방어형 랜섬웨어 대응 시스템**으로서, 이상 행위 감지와 빠른 프로세스 차단을 통해 피해를 최소화하는 것을 목표로 합니다.

---

📌 참고: 랜섬웨어대응연구회에서 ransom zero와 관련된 강연을 참고함
        강연 관련된 pdf 파일 첨부
[2025 랜섬웨어대응연구회 워크샵 온라인 프로시딩-125-136.pdf](https://github.com/user-attachments/files/20643682/2025.-125-136.pdf)
